!function(t){var e={};function r(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t){t.exports={buffer:[-.5,-.5,.5,-.5,.5,.5,-.5,.5],indices:[0,1,2,2,3,0],layout:[["float",2]]}},function(t){t.exports={buffer:[-.5,.5,-.5,0,1,0,0,1,-.5,.5,.5,0,1,0,1,1,.5,.5,.5,0,1,0,1,0,.5,.5,-.5,0,1,0,0,0,-.5,.5,.5,-1,0,0,0,0,-.5,-.5,.5,-1,0,0,0,1,-.5,-.5,-.5,-1,0,0,1,1,-.5,.5,-.5,-1,0,0,1,0,.5,.5,.5,1,0,0,0,0,.5,-.5,.5,1,0,0,0,1,.5,-.5,-.5,1,0,0,1,1,.5,.5,-.5,1,0,0,1,0,.5,.5,.5,0,0,-1,0,0,.5,-.5,.5,0,0,-1,0,1,-.5,-.5,.5,0,0,-1,1,1,-.5,.5,.5,0,0,-1,1,0,.5,.5,-.5,0,0,1,0,0,.5,-.5,-.5,0,0,1,0,1,-.5,-.5,-.5,0,0,1,1,1,-.5,.5,-.5,0,0,1,1,0,-.5,-.5,-.5,0,-1,0,0,1,-.5,-.5,.5,0,-1,0,1,1,.5,-.5,.5,0,-1,0,1,0,.5,-.5,-.5,0,-1,0,0,0],indices:[0,1,2,0,2,3,5,4,6,6,4,7,8,9,10,8,10,11,13,12,14,15,14,12,16,17,18,16,18,19,21,20,22,22,20,23],layout:[["float",3],["normalized float",3],["float",2]]}},function(t,e,r){"use strict";r.r(e);class a{static create(){let t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}static fromMat4(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}static clone(t){let e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}static copy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}static fromValues(t,e,r,a,i,s,n,h,o){let l=new Float32Array(9);return l[0]=t,l[1]=e,l[2]=r,l[3]=a,l[4]=i,l[5]=s,l[6]=n,l[7]=h,l[8]=o,l}static set(t,e,r,a,i,s,n,h,o,l){return t[0]=e,t[1]=r,t[2]=a,t[3]=i,t[4]=s,t[5]=n,t[6]=h,t[7]=o,t[8]=l,t}static identity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}static transpose(t,e){if(t===e){let r=e[1],a=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=a,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}static invert(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=e[4],h=e[5],o=e[6],l=e[7],c=e[8],u=c*n-h*l,d=-c*s+h*o,g=l*s-n*o,f=r*u+a*d+i*g;return f?(f=1/f,t[0]=u*f,t[1]=(-c*a+i*l)*f,t[2]=(h*a-i*n)*f,t[3]=d*f,t[4]=(c*r-i*o)*f,t[5]=(-h*r+i*s)*f,t[6]=g*f,t[7]=(-l*r+a*o)*f,t[8]=(n*r-a*s)*f,t):null}static adjoint(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=e[4],h=e[5],o=e[6],l=e[7],c=e[8];return t[0]=n*c-h*l,t[1]=i*l-a*c,t[2]=a*h-i*n,t[3]=h*o-s*c,t[4]=r*c-i*o,t[5]=i*s-r*h,t[6]=s*l-n*o,t[7]=a*o-r*l,t[8]=r*n-a*s,t}static determinant(t){let e=t[0],r=t[1],a=t[2],i=t[3],s=t[4],n=t[5],h=t[6],o=t[7],l=t[8];return e*(l*s-n*o)+r*(-l*i+n*h)+a*(o*i-s*h)}static multiply(t,e,r){let a=e[0],i=e[1],s=e[2],n=e[3],h=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=r[0],g=r[1],f=r[2],m=r[3],M=r[4],v=r[5],p=r[6],A=r[7],E=r[8];return t[0]=d*a+g*n+f*l,t[1]=d*i+g*h+f*c,t[2]=d*s+g*o+f*u,t[3]=m*a+M*n+v*l,t[4]=m*i+M*h+v*c,t[5]=m*s+M*o+v*u,t[6]=p*a+A*n+E*l,t[7]=p*i+A*h+E*c,t[8]=p*s+A*o+E*u,t}static translate(t,e,r){let a=e[0],i=e[1],s=e[2],n=e[3],h=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=r[0],g=r[1];return t[0]=a,t[1]=i,t[2]=s,t[3]=n,t[4]=h,t[5]=o,t[6]=d*a+g*n+l,t[7]=d*i+g*h+c,t[8]=d*s+g*o+u,t}static rotate(t,e,r){let a=e[0],i=e[1],s=e[2],n=e[3],h=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=Math.sin(r),g=Math.cos(r);return t[0]=g*a+d*n,t[1]=g*i+d*h,t[2]=g*s+d*o,t[3]=g*n-d*a,t[4]=g*h-d*i,t[5]=g*o-d*s,t[6]=l,t[7]=c,t[8]=u,t}static scale(t,e,r){let a=r[0],i=r[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}static fromTranslation(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}static fromRotation(t,e){let r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=-r,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}static fromScaling(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}static fromMat2d(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}static fromQuat(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=r+r,h=a+a,o=i+i,l=r*n,c=a*n,u=a*h,d=i*n,g=i*h,f=i*o,m=s*n,M=s*h,v=s*o;return t[0]=1-u-f,t[3]=c-v,t[6]=d+M,t[1]=c+v,t[4]=1-l-f,t[7]=g-m,t[2]=d-M,t[5]=g+m,t[8]=1-l-u,t}static normalFromMat4(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=e[4],h=e[5],o=e[6],l=e[7],c=e[8],u=e[9],d=e[10],g=e[11],f=e[12],m=e[13],M=e[14],v=e[15],p=r*h-a*n,A=r*o-i*n,E=r*l-s*n,y=a*o-i*h,b=a*l-s*h,x=i*l-s*o,w=c*m-u*f,T=c*M-d*f,S=c*v-g*f,U=u*M-d*m,R=u*v-g*m,P=d*v-g*M,F=p*P-A*R+E*U+y*S-b*T+x*w;return F?(F=1/F,t[0]=(h*P-o*R+l*U)*F,t[1]=(o*S-n*P-l*T)*F,t[2]=(n*R-h*S+l*w)*F,t[3]=(i*R-a*P-s*U)*F,t[4]=(r*P-i*S+s*T)*F,t[5]=(a*S-r*R-s*w)*F,t[6]=(m*x-M*b+v*y)*F,t[7]=(M*E-f*x-v*A)*F,t[8]=(f*b-m*E+v*p)*F,t):null}static projection(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}static str(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}static frob(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}static add(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}static subtract(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}static multiplyScalar(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}static multiplyScalarAndAdd(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t[6]=e[6]+r[6]*a,t[7]=e[7]+r[7]*a,t[8]=e[8]+r[8]*a,t}static exactEquals(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}}class i{static create(){let t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}static clone(t){let e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}static copy(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}static fromValues(t,e,r,a,i,s,n,h,o,l,c,u,d,g,f,m){let M=new Float32Array(16);return M[0]=t,M[1]=e,M[2]=r,M[3]=a,M[4]=i,M[5]=s,M[6]=n,M[7]=h,M[8]=o,M[9]=l,M[10]=c,M[11]=u,M[12]=d,M[13]=g,M[14]=f,M[15]=m,M}static set(t,e,r,a,i,s,n,h,o,l,c,u,d,g,f,m,M){return t[0]=e,t[1]=r,t[2]=a,t[3]=i,t[4]=s,t[5]=n,t[6]=h,t[7]=o,t[8]=l,t[9]=c,t[10]=u,t[11]=d,t[12]=g,t[13]=f,t[14]=m,t[15]=M,t}static identity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}static transpose(t,e){if(t===e){let r=e[1],a=e[2],i=e[3],s=e[6],n=e[7],h=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=s,t[11]=e[14],t[12]=i,t[13]=n,t[14]=h}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}static invert(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=e[4],h=e[5],o=e[6],l=e[7],c=e[8],u=e[9],d=e[10],g=e[11],f=e[12],m=e[13],M=e[14],v=e[15],p=r*h-a*n,A=r*o-i*n,E=r*l-s*n,y=a*o-i*h,b=a*l-s*h,x=i*l-s*o,w=c*m-u*f,T=c*M-d*f,S=c*v-g*f,U=u*M-d*m,R=u*v-g*m,P=d*v-g*M,F=p*P-A*R+E*U+y*S-b*T+x*w;return F?(F=1/F,t[0]=(h*P-o*R+l*U)*F,t[1]=(i*R-a*P-s*U)*F,t[2]=(m*x-M*b+v*y)*F,t[3]=(d*b-u*x-g*y)*F,t[4]=(o*S-n*P-l*T)*F,t[5]=(r*P-i*S+s*T)*F,t[6]=(M*E-f*x-v*A)*F,t[7]=(c*x-d*E+g*A)*F,t[8]=(n*R-h*S+l*w)*F,t[9]=(a*S-r*R-s*w)*F,t[10]=(f*b-m*E+v*p)*F,t[11]=(u*E-c*b-g*p)*F,t[12]=(h*T-n*U-o*w)*F,t[13]=(r*U-a*T+i*w)*F,t[14]=(m*A-f*y-M*p)*F,t[15]=(c*y-u*A+d*p)*F,t):null}static adjoint(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=e[4],h=e[5],o=e[6],l=e[7],c=e[8],u=e[9],d=e[10],g=e[11],f=e[12],m=e[13],M=e[14],v=e[15];return t[0]=h*(d*v-g*M)-u*(o*v-l*M)+m*(o*g-l*d),t[1]=-(a*(d*v-g*M)-u*(i*v-s*M)+m*(i*g-s*d)),t[2]=a*(o*v-l*M)-h*(i*v-s*M)+m*(i*l-s*o),t[3]=-(a*(o*g-l*d)-h*(i*g-s*d)+u*(i*l-s*o)),t[4]=-(n*(d*v-g*M)-c*(o*v-l*M)+f*(o*g-l*d)),t[5]=r*(d*v-g*M)-c*(i*v-s*M)+f*(i*g-s*d),t[6]=-(r*(o*v-l*M)-n*(i*v-s*M)+f*(i*l-s*o)),t[7]=r*(o*g-l*d)-n*(i*g-s*d)+c*(i*l-s*o),t[8]=n*(u*v-g*m)-c*(h*v-l*m)+f*(h*g-l*u),t[9]=-(r*(u*v-g*m)-c*(a*v-s*m)+f*(a*g-s*u)),t[10]=r*(h*v-l*m)-n*(a*v-s*m)+f*(a*l-s*h),t[11]=-(r*(h*g-l*u)-n*(a*g-s*u)+c*(a*l-s*h)),t[12]=-(n*(u*M-d*m)-c*(h*M-o*m)+f*(h*d-o*u)),t[13]=r*(u*M-d*m)-c*(a*M-i*m)+f*(a*d-i*u),t[14]=-(r*(h*M-o*m)-n*(a*M-i*m)+f*(a*o-i*h)),t[15]=r*(h*d-o*u)-n*(a*d-i*u)+c*(a*o-i*h),t}static determinant(t){let e=t[0],r=t[1],a=t[2],i=t[3],s=t[4],n=t[5],h=t[6],o=t[7],l=t[8],c=t[9],u=t[10],d=t[11],g=t[12],f=t[13],m=t[14],M=t[15];return(e*n-r*s)*(u*M-d*m)-(e*h-a*s)*(c*M-d*f)+(e*o-i*s)*(c*m-u*f)+(r*h-a*n)*(l*M-d*g)-(r*o-i*n)*(l*m-u*g)+(a*o-i*h)*(l*f-c*g)}static multiply(t,e,r){let a=e[0],i=e[1],s=e[2],n=e[3],h=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=e[9],g=e[10],f=e[11],m=e[12],M=e[13],v=e[14],p=e[15],A=r[0],E=r[1],y=r[2],b=r[3];return t[0]=A*a+E*h+y*u+b*m,t[1]=A*i+E*o+y*d+b*M,t[2]=A*s+E*l+y*g+b*v,t[3]=A*n+E*c+y*f+b*p,A=r[4],E=r[5],y=r[6],b=r[7],t[4]=A*a+E*h+y*u+b*m,t[5]=A*i+E*o+y*d+b*M,t[6]=A*s+E*l+y*g+b*v,t[7]=A*n+E*c+y*f+b*p,A=r[8],E=r[9],y=r[10],b=r[11],t[8]=A*a+E*h+y*u+b*m,t[9]=A*i+E*o+y*d+b*M,t[10]=A*s+E*l+y*g+b*v,t[11]=A*n+E*c+y*f+b*p,A=r[12],E=r[13],y=r[14],b=r[15],t[12]=A*a+E*h+y*u+b*m,t[13]=A*i+E*o+y*d+b*M,t[14]=A*s+E*l+y*g+b*v,t[15]=A*n+E*c+y*f+b*p,t}static translate(t,e,r){let a,i,s,n,h,o,l,c,u,d,g,f,m=r[0],M=r[1],v=r[2];return e===t?(t[12]=e[0]*m+e[4]*M+e[8]*v+e[12],t[13]=e[1]*m+e[5]*M+e[9]*v+e[13],t[14]=e[2]*m+e[6]*M+e[10]*v+e[14],t[15]=e[3]*m+e[7]*M+e[11]*v+e[15]):(a=e[0],i=e[1],s=e[2],n=e[3],h=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=e[9],g=e[10],f=e[11],t[0]=a,t[1]=i,t[2]=s,t[3]=n,t[4]=h,t[5]=o,t[6]=l,t[7]=c,t[8]=u,t[9]=d,t[10]=g,t[11]=f,t[12]=a*m+h*M+u*v+e[12],t[13]=i*m+o*M+d*v+e[13],t[14]=s*m+l*M+g*v+e[14],t[15]=n*m+c*M+f*v+e[15]),t}static scale(t,e,r){let a=r[0],i=r[1],s=r[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}static rotate(t,e,r,a){let i,s,n,h,o,l,c,u,d,g,f,m,M,v,p,A,E,y,b,x,w,T,S,U,R=a[0],P=a[1],F=a[2],C=Math.hypot(R,P,F);return C<1e-6?null:(R*=C=1/C,P*=C,F*=C,i=Math.sin(r),n=1-(s=Math.cos(r)),h=e[0],o=e[1],l=e[2],c=e[3],u=e[4],d=e[5],g=e[6],f=e[7],m=e[8],M=e[9],v=e[10],p=e[11],A=R*R*n+s,E=P*R*n+F*i,y=F*R*n-P*i,b=R*P*n-F*i,x=P*P*n+s,w=F*P*n+R*i,T=R*F*n+P*i,S=P*F*n-R*i,U=F*F*n+s,t[0]=h*A+u*E+m*y,t[1]=o*A+d*E+M*y,t[2]=l*A+g*E+v*y,t[3]=c*A+f*E+p*y,t[4]=h*b+u*x+m*w,t[5]=o*b+d*x+M*w,t[6]=l*b+g*x+v*w,t[7]=c*b+f*x+p*w,t[8]=h*T+u*S+m*U,t[9]=o*T+d*S+M*U,t[10]=l*T+g*S+v*U,t[11]=c*T+f*S+p*U,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}static rotateX(t,e,r){let a=Math.sin(r),i=Math.cos(r),s=e[4],n=e[5],h=e[6],o=e[7],l=e[8],c=e[9],u=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+l*a,t[5]=n*i+c*a,t[6]=h*i+u*a,t[7]=o*i+d*a,t[8]=l*i-s*a,t[9]=c*i-n*a,t[10]=u*i-h*a,t[11]=d*i-o*a,t}static rotateY(t,e,r){let a=Math.sin(r),i=Math.cos(r),s=e[0],n=e[1],h=e[2],o=e[3],l=e[8],c=e[9],u=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-l*a,t[1]=n*i-c*a,t[2]=h*i-u*a,t[3]=o*i-d*a,t[8]=s*a+l*i,t[9]=n*a+c*i,t[10]=h*a+u*i,t[11]=o*a+d*i,t}static rotateZ(t,e,r){let a=Math.sin(r),i=Math.cos(r),s=e[0],n=e[1],h=e[2],o=e[3],l=e[4],c=e[5],u=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+l*a,t[1]=n*i+c*a,t[2]=h*i+u*a,t[3]=o*i+d*a,t[4]=l*i-s*a,t[5]=c*i-n*a,t[6]=u*i-h*a,t[7]=d*i-o*a,t}static fromTranslation(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}static fromScaling(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}static fromRotation(t,e,r){let a,i,s,n=r[0],h=r[1],o=r[2],l=Math.hypot(n,h,o);return l<1e-6?null:(n*=l=1/l,h*=l,o*=l,a=Math.sin(e),s=1-(i=Math.cos(e)),t[0]=n*n*s+i,t[1]=h*n*s+o*a,t[2]=o*n*s-h*a,t[3]=0,t[4]=n*h*s-o*a,t[5]=h*h*s+i,t[6]=o*h*s+n*a,t[7]=0,t[8]=n*o*s+h*a,t[9]=h*o*s-n*a,t[10]=o*o*s+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}static fromXRotation(t,e){let r=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}static fromYRotation(t,e){let r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}static fromZRotation(t,e){let r=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}static fromRotationTranslation(t,e,r){let a=e[0],i=e[1],s=e[2],n=e[3],h=a+a,o=i+i,l=s+s,c=a*h,u=a*o,d=a*l,g=i*o,f=i*l,m=s*l,M=n*h,v=n*o,p=n*l;return t[0]=1-(g+m),t[1]=u+p,t[2]=d-v,t[3]=0,t[4]=u-p,t[5]=1-(c+m),t[6]=f+M,t[7]=0,t[8]=d+v,t[9]=f-M,t[10]=1-(c+g),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}static fromQuat2(t,e){let r=new Float32Array(3),a=-e[0],i=-e[1],s=-e[2],n=e[3],h=e[4],o=e[5],l=e[6],c=e[7],u=a*a+i*i+s*s+n*n;return u>0?(r[0]=2*(h*n+c*a+o*s-l*i)/u,r[1]=2*(o*n+c*i+l*a-h*s)/u,r[2]=2*(l*n+c*s+h*i-o*a)/u):(r[0]=2*(h*n+c*a+o*s-l*i),r[1]=2*(o*n+c*i+l*a-h*s),r[2]=2*(l*n+c*s+h*i-o*a)),fromRotationTranslation(t,e,r),t}static getTranslation(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}static getScaling(t,e){let r=e[0],a=e[1],i=e[2],s=e[4],n=e[5],h=e[6],o=e[8],l=e[9],c=e[10];return t[0]=Math.hypot(r,a,i),t[1]=Math.hypot(s,n,h),t[2]=Math.hypot(o,l,c),t}static getRotation(t,e){let r=new Float32Array(3);getScaling(r,e);let a=1/r[0],i=1/r[1],s=1/r[2],n=e[0]*a,h=e[1]*i,o=e[2]*s,l=e[4]*a,c=e[5]*i,u=e[6]*s,d=e[8]*a,g=e[9]*i,f=e[10]*s,m=n+c+f,M=0;return m>0?(M=2*Math.sqrt(m+1),t[3]=.25*M,t[0]=(u-g)/M,t[1]=(d-o)/M,t[2]=(h-l)/M):n>c&&n>f?(M=2*Math.sqrt(1+n-c-f),t[3]=(u-g)/M,t[0]=.25*M,t[1]=(h+l)/M,t[2]=(d+o)/M):c>f?(M=2*Math.sqrt(1+c-n-f),t[3]=(d-o)/M,t[0]=(h+l)/M,t[1]=.25*M,t[2]=(u+g)/M):(M=2*Math.sqrt(1+f-n-c),t[3]=(h-l)/M,t[0]=(d+o)/M,t[1]=(u+g)/M,t[2]=.25*M),t}static fromRotationTranslationScale(t,e,r,a){let i=e[0],s=e[1],n=e[2],h=e[3],o=i+i,l=s+s,c=n+n,u=i*o,d=i*l,g=i*c,f=s*l,m=s*c,M=n*c,v=h*o,p=h*l,A=h*c,E=a[0],y=a[1],b=a[2];return t[0]=(1-(f+M))*E,t[1]=(d+A)*E,t[2]=(g-p)*E,t[3]=0,t[4]=(d-A)*y,t[5]=(1-(u+M))*y,t[6]=(m+v)*y,t[7]=0,t[8]=(g+p)*b,t[9]=(m-v)*b,t[10]=(1-(u+f))*b,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}static fromRotationTranslationScaleOrigin(t,e,r,a,i){let s=e[0],n=e[1],h=e[2],o=e[3],l=s+s,c=n+n,u=h+h,d=s*l,g=s*c,f=s*u,m=n*c,M=n*u,v=h*u,p=o*l,A=o*c,E=o*u,y=a[0],b=a[1],x=a[2],w=i[0],T=i[1],S=i[2],U=(1-(m+v))*y,R=(g+E)*y,P=(f-A)*y,F=(g-E)*b,C=(1-(d+v))*b,_=(M+p)*b,B=(f+A)*x,L=(M-p)*x,I=(1-(d+m))*x;return t[0]=U,t[1]=R,t[2]=P,t[3]=0,t[4]=F,t[5]=C,t[6]=_,t[7]=0,t[8]=B,t[9]=L,t[10]=I,t[11]=0,t[12]=r[0]+w-(U*w+F*T+B*S),t[13]=r[1]+T-(R*w+C*T+L*S),t[14]=r[2]+S-(P*w+_*T+I*S),t[15]=1,t}static fromQuat(t,e){let r=e[0],a=e[1],i=e[2],s=e[3],n=r+r,h=a+a,o=i+i,l=r*n,c=a*n,u=a*h,d=i*n,g=i*h,f=i*o,m=s*n,M=s*h,v=s*o;return t[0]=1-u-f,t[1]=c+v,t[2]=d-M,t[3]=0,t[4]=c-v,t[5]=1-l-f,t[6]=g+m,t[7]=0,t[8]=d+M,t[9]=g-m,t[10]=1-l-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}static frustum(t,e,r,a,i,s,n){let h=1/(r-e),o=1/(i-a),l=1/(s-n);return t[0]=2*s*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*o,t[6]=0,t[7]=0,t[8]=(r+e)*h,t[9]=(i+a)*o,t[10]=(n+s)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=n*s*2*l,t[15]=0,t}static perspective(t,e,r,a,i){let s,n=1/Math.tan(e/2);return t[0]=n/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(a-i),t[10]=(i+a)*s,t[14]=2*i*a*s):(t[10]=-1,t[14]=-2*a),t}static perspectiveFromFieldOfView(t,e,r,a){let i=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),n=Math.tan(e.leftDegrees*Math.PI/180),h=Math.tan(e.rightDegrees*Math.PI/180),o=2/(n+h),l=2/(i+s);return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(n-h)*o*.5,t[9]=(i-s)*l*.5,t[10]=a/(r-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*r/(r-a),t[15]=0,t}static ortho(t,e,r,a,i,s,n){let h=1/(e-r),o=1/(a-i),l=1/(s-n);return t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+r)*h,t[13]=(i+a)*o,t[14]=(n+s)*l,t[15]=1,t}static lookAt(t,e,r,a){let i,s,n,h,o,l,c,u,d,g,f=e[0],m=e[1],M=e[2],v=a[0],p=a[1],A=a[2],E=r[0],y=r[1],b=r[2];return Math.abs(f-E)<1e-6&&Math.abs(m-y)<1e-6&&Math.abs(M-b)<1e-6?this.identity(t):(c=f-E,u=m-y,d=M-b,i=p*(d*=g=1/Math.hypot(c,u,d))-A*(u*=g),s=A*(c*=g)-v*d,n=v*u-p*c,(g=Math.hypot(i,s,n))?(i*=g=1/g,s*=g,n*=g):(i=0,s=0,n=0),h=u*n-d*s,o=d*i-c*n,l=c*s-u*i,(g=Math.hypot(h,o,l))?(h*=g=1/g,o*=g,l*=g):(h=0,o=0,l=0),t[0]=i,t[1]=h,t[2]=c,t[3]=0,t[4]=s,t[5]=o,t[6]=u,t[7]=0,t[8]=n,t[9]=l,t[10]=d,t[11]=0,t[12]=-(i*f+s*m+n*M),t[13]=-(h*f+o*m+l*M),t[14]=-(c*f+u*m+d*M),t[15]=1,t)}static targetTo(t,e,r,a){let i=e[0],s=e[1],n=e[2],h=a[0],o=a[1],l=a[2],c=i-r[0],u=s-r[1],d=n-r[2],g=c*c+u*u+d*d;g>0&&(c*=g=1/Math.sqrt(g),u*=g,d*=g);let f=o*d-l*u,m=l*c-h*d,M=h*u-o*c;return(g=f*f+m*m+M*M)>0&&(f*=g=1/Math.sqrt(g),m*=g,M*=g),t[0]=f,t[1]=m,t[2]=M,t[3]=0,t[4]=u*M-d*m,t[5]=d*f-c*M,t[6]=c*m-u*f,t[7]=0,t[8]=c,t[9]=u,t[10]=d,t[11]=0,t[12]=i,t[13]=s,t[14]=n,t[15]=1,t}static str(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}static frob(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}static add(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}static subtract(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}static multiplyScalar(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}static multiplyScalarAndAdd(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t[2]=e[2]+r[2]*a,t[3]=e[3]+r[3]*a,t[4]=e[4]+r[4]*a,t[5]=e[5]+r[5]*a,t[6]=e[6]+r[6]*a,t[7]=e[7]+r[7]*a,t[8]=e[8]+r[8]*a,t[9]=e[9]+r[9]*a,t[10]=e[10]+r[10]*a,t[11]=e[11]+r[11]*a,t[12]=e[12]+r[12]*a,t[13]=e[13]+r[13]*a,t[14]=e[14]+r[14]*a,t[15]=e[15]+r[15]*a,t}static exactEquals(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}static equals(t,e){let r=t[0],a=t[1],i=t[2],s=t[3],n=t[4],h=t[5],o=t[6],l=t[7],c=t[8],u=t[9],d=t[10],g=t[11],f=t[12],m=t[13],M=t[14],v=t[15],p=e[0],A=e[1],E=e[2],y=e[3],b=e[4],x=e[5],w=e[6],T=e[7],S=e[8],U=e[9],R=e[10],P=e[11],F=e[12],C=e[13],_=e[14],B=e[15];return Math.abs(r-p)<=1e-6*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(a-A)<=1e-6*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(i-E)<=1e-6*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(s-y)<=1e-6*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(n-b)<=1e-6*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(h-x)<=1e-6*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(o-w)<=1e-6*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(l-T)<=1e-6*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-S)<=1e-6*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-U)<=1e-6*Math.max(1,Math.abs(u),Math.abs(U))&&Math.abs(d-R)<=1e-6*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(g-P)<=1e-6*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(f-F)<=1e-6*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(m-C)<=1e-6*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(M-_)<=1e-6*Math.max(1,Math.abs(M),Math.abs(_))&&Math.abs(v-B)<=1e-6*Math.max(1,Math.abs(v),Math.abs(B))}}class s{constructor(t=0,e=0,r=0,a=0){this.x=t,this.y=e,this.width=r,this.height=a,this.color=[1,1,1,1]}setDimensions(t,e,r,a){this.x=t,this.y=e,this.width=r,this.height=a}setColor(t,e,r,a){this.color=[t,e,r,a]}calculateMatrix(t,e){t/=2,e/=2;var r=new Float32Array([1/t*this.width,0,0,0,1/e*this.height,0,0,0,1]),i=new Float32Array([1,0,0,0,1,0,(this.x+this.width/2)/t-1,(-this.y-this.height/2)/e+1,1]),s=new Float32Array(9);return a.identity(s),a.multiply(s,i,r),s}draw(t){var e=t.shapes.RECTANGLE_SHAPE;e.shaderProg.bind(),t.gl.disable(t.gl.DEPTH_TEST),e.shaderProg.setUniformMatrix3f("affine",this.calculateMatrix(t.canvas.width,t.canvas.height)),e.shaderProg.setUniform4f("u_Color",this.color[0],this.color[1],this.color[2],this.color[3]),t.display.draw(e.mesh,e.shaderProg),t.gl.enable(t.gl.DEPTH_TEST)}}class n{constructor(){this.elements=[],this.stride=0}setContext(t){this.gl=t}getElementTypeSize(t){switch(t){case this.gl.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case this.gl.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case this.gl.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT}throw`AGL: Unknown buffer element type ${t}`}addFloat(t,e=!1){this.elements.push({type:this.gl.FLOAT,count:t,normalized:e});var r=0;this.elements.forEach((t,e)=>{r+=t.count*e}),console.log(r,e,t),this.stride+=t*Float32Array.BYTES_PER_ELEMENT}addUint(t){this.elements.push({type:this.gl.UNSIGNED_INT,count:t,normalized:!1}),this.stride+=t*Uint32Array.BYTES_PER_ELEMENT}addUchar(t){this.elements.push({type:this.gl.UNSIGNED_BYTE,count:t,normalized:!1}),this.stride+=t*Uint8Array.BYTES_PER_ELEMENT}}var h=r(0),o="precision mediump float;\n\nattribute vec2 vertexPosition;\n// Rectangle color\nuniform vec4 u_Color;\n// Homogenous matrix\nuniform mat3 affine;\nvarying vec4 color;\n\nvoid main()\n{\n  color = u_Color;\n  gl_Position = vec4(affine * vec3(vertexPosition, 1.0), 1);\n}",l="precision mediump float;\n\nvarying vec4 color;\n\n\nvoid main()\n{\n  gl_FragColor = color;\n}";class c{static register(t,e){var r=e.createMesh(),a=e.createShaderProgram(),i=e.createShader(0),s=e.createShader(1);i.compile(o),s.compile(l),a.attachShader(i),a.attachShader(s),r.createFromObject(h),a.link(),t.RECTANGLE_SHAPE={},t.RECTANGLE_SHAPE.mesh=r,t.RECTANGLE_SHAPE.shaderProg=a}}var u={VertexArray:class{constructor(){}setContext(t){this.gl=t}setWizard(t){this.wiz=t}assignId(t){this.id=t}bind(){if(this.wiz.vaoBound!=this.id){this.wiz.vaoBound=this.id,this.buf.bind();var t=0;this.layout.elements.forEach((e,r)=>{this.gl.vertexAttribPointer(r,e.count,e.type,e.normalized,this.layout.stride,t),this.gl.enableVertexAttribArray(r),t+=e.count*this.layout.getElementTypeSize(e.type)})}}unbind(){}addBuffer(t,e){this.layout=e,this.buf=t}},Display:class{setContext(t){this.gl=t,t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)}draw(t,e){e.bind(),t.bind(),this.gl.drawElements(this.gl.TRIANGLES,t.getIndicesLength(),this.gl.UNSIGNED_SHORT,0)}render(t,e){t.draw(this,e)}clearColor(t,e,r,a){this.gl.clearColor(t,e,r,a)}clear(){this.gl.clear(this.gl.DEPTH_BUFFER_BIT|this.gl.COLOR_BUFFER_BIT)}enableCulling(t=1){t?(this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CCW),this.gl.cullFace(this.gl.BACK)):(this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE))}},VertexBuffer:class{setContext(t){this.gl=t}constructor(){}createBuffer(t){this.vbo=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}destruct(){this.gl.deleteBuffer(this.vbo)}bind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vbo)}unbind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,0)}},IndexBuffer:class{setContext(t){this.gl=t}constructor(){}createBuffer(t){this.ibo=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,t,this.gl.STATIC_DRAW)}destruct(){this.gl.deleteBuffer(this.ibo)}bind(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.ibo)}unbind(){this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,0)}},Shader:class{constructor(t){this.types={Vertex:0,Fragment:1},this.type=t}setContext(t){this.gl=t}toGLType(t){switch(t){case this.types.Vertex:return this.gl.VERTEX_SHADER;case this.types.Fragment:return this.gl.FRAGMENT_SHADER}throw`AGL: Unknown shader type ${t}`}typeString(t){switch(t){case this.types.Vertex:return"vertex";case this.types.Fragment:return"fragment"}throw`AGL: Unknown shader type ${t}`}compile(t){var e;if(this.shaderId=this.gl.createShader(this.toGLType(this.type)),this.gl.shaderSource(this.shaderId,t),this.gl.compileShader(this.shaderId),!this.gl.getShaderParameter(this.shaderId,this.gl.COMPILE_STATUS))throw e=this.gl.getShaderInfoLog(this.shaderId),`AGL: Error compiling ${this.typeString(this.type)} shader: ${e}`}destruct(){this.gl.deleteShader(this.shaderId)}},ShaderProgram:class{constructor(){this.ufCache=[]}setContext(t){this.gl=t}create(){this.progid=this.gl.createProgram()}createFrom(t,e){this.attachShader(t),this.attachShader(e),this.link()}destruct(){this.gl.deleteProgram(this.progid)}bind(){this.gl.useProgram(this.progid)}unbind(){this.gl.useProgram(0)}attachShader(t){this.gl.attachShader(this.progid,t.shaderId)}link(){if(this.gl.linkProgram(this.progid),!this.gl.getProgramParameter(this.progid,this.gl.LINK_STATUS))throw"AGL: Error linking program";if(this.gl.validateProgram(this.progid),!this.gl.getProgramParameter(this.progid,this.gl.VALIDATE_STATUS))throw"AGL: Error validating program"}getUniformLocation(t){var e=this.ufCache[t];if(void 0!==e)return e;var r=this.gl.getUniformLocation(this.progid,t);return-1!==r?(this.ufCache[t]=r,this.ufCache[t]):r}getSafeUniformLocation(t){var e=this.getUniformLocation(t);if(-1==e)throw"AGL: Cannot find uniform, it's either not used or not declared";return e}setUniform1i(t,e){var r=this.getSafeUniformLocation(t);this.gl.uniform1i(r,e)}setUniform1f(t,e){var r=this.getSafeUniformLocation(t);this.gl.uniform1f(r,e)}setUniform2f(t,e,r){var a=this.getSafeUniformLocation(t);this.gl.uniform2f(a,e,r)}setUniform3f(t,e,r,a){var i=this.getSafeUniformLocation(t);this.gl.uniform3f(i,e,r,a)}setUniform4f(t,e,r,a,i){var s=this.getSafeUniformLocation(t);this.gl.uniform4f(s,e,r,a,i)}setUniformMatrix2f(t,e,r=!1){var a=this.getSafeUniformLocation(t);this.gl.uniformMatrix2fv(a,r,e)}setUniformMatrix3f(t,e,r=!1){var a=this.getSafeUniformLocation(t);this.gl.uniformMatrix3fv(a,r,e)}setUniformMatrix4f(t,e,r=!1){var a=this.getSafeUniformLocation(t);this.gl.uniformMatrix4fv(a,r,e)}},Texture:class{constructor(){this.texId=0}setContext(t){this.gl=t}fromImage(t){this.texId=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texId),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texId)}bind(t=0){this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texId)}destruct(){this.gl.deleteTexture(this.texId)}},BufferLayout:n,Mesh:class{constructor(t=null,e=null){this.create(t,e)}create(t,e){this.vao=t,this.ibo=e}setWizard(t){this.wiz=t}createFromObject(t){var e=new n;e.setContext(this.gl),t.layout.forEach(t=>{if("float"==t[0])e.addFloat(t[1]);else if("normalized float"==t[0])e.addFloat(t[1],!0);else if("uint"==t[0]||"unsigned int"==t[0])e.addUint(t[1]);else{if("uchar"!=t[0]&&"unsigned char"!=t[0])throw`AGL: uncaught layout element type: ${t[0]}, avalible types: float, uint | unsigned int, uchar | unsigned char`;e.addUchar(t[1])}});var r=this.wiz.createVertexBuffer();r.createBuffer(new Float32Array(t.buffer)),this.vao=this.wiz.createVertexArray(),this.ibo=this.wiz.createIndexBuffer(),this.vao.setContext(this.gl),this.ibo.setContext(this.gl),this.ibo.createBuffer(new Uint16Array(t.indices)),this.vao.addBuffer(r,e),this.indicesLength=t.indices.length}setContext(t){this.gl=t}setTexture(t){this.tex=t}getIndicesLength(){return this.indicesLength}bind(){this.vao.bind(),this.ibo.bind(),void 0!==this.tex&&this.tex.bind()}unbind(){this.vao.unbind(),this.ibo.unbind()}destruct(){this.vao.destruct(),this.ibo.destruct(),void 0!==this.tex&&this.tex.destruct(),delete this.vao,delete this.ibo,void 0!==this.tex&&delete this.tex}}};class d{constructor(t=null){this.gl=t,this.vaoBound=null,this.lastVaoId=0}setContext(t){this.gl=t}createBufferLayout(){var t=new u.BufferLayout;return t.setContext(this.gl),t}createMesh(t=null,e=null){var r=new u.Mesh(t,e);return r.setContext(this.gl),r.setWizard(this),r}createDisplay(){var t=new u.Display;return t.setContext(this.gl),t}createIndexBuffer(){var t=new u.IndexBuffer;return t.setContext(this.gl),t}createShader(t){var e=new u.Shader(t);return e.setContext(this.gl),e}createShaderProgram(){var t=new u.ShaderProgram;return t.setContext(this.gl),t.create(),t}createTexture(){var t=new u.Texture;return t.setContext(this.gl),t}createVertexArray(){var t=new u.VertexArray;return t.setContext(this.gl),t.setWizard(this),t.assignId(this.lastVaoId),this.lastVaoId++,t}createVertexBuffer(){var t=new u.VertexBuffer;return t.setContext(this.gl),t}}var g=r(1),f="\nprecision mediump float;\n\nattribute vec3 position;\nattribute vec3 normCoord;\nattribute vec2 uv;\n\nvarying vec4 fragColor;\nvarying vec2 fragUV;\n\nuniform mat4 world;\nuniform mat4 view;\nuniform mat4 projection;\nuniform mat4 normalMatrix;\n\n\nvoid main() {  \n  vec3 ambient = vec3(0.5, 0.4, 0.4);\n  vec3 sunlight = vec3(0.6, 0.6, 0.6);\n  vec3 lightDirection = normalize(vec3(8, 0.2, 1.0));\n\n\n  fragUV = uv;\n\n\n  fragColor = vec4(ambient + sunlight * max(dot(normCoord, lightDirection), 0.0), 1.0);  \n  gl_Position = projection * view * world * vec4(position, 1.0);\n}",m="precision mediump float;\nvarying vec4 fragColor;\nvarying vec2 fragUV;\n\nuniform sampler2D _sampler; \n\n\n\nvoid main() {\n\n  gl_FragColor = texture2D(_sampler, fragUV) * fragColor;\n  \n}";class M{static register(t,e){var r=e.createMesh(),a=e.createShaderProgram(),i=e.createShader(0),s=e.createShader(1);i.compile(f),s.compile(m),a.attachShader(i),a.attachShader(s),r.createFromObject(g);var n=new Image;n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV/TarVUHOwg4pChOlkQFXHUKhShQqgVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi4uqk6CIl/i8ptIj14Lgf7+497t4BQr3MNCswDmi6baYScTGTXRWDr+hGL0IQEJCZZcxJUhIdx9c9fHy9i/Gszuf+HH1qzmKATySeZYZpE28QT2/aBud94ggryirxOfGYSRckfuS64vEb54LLAs+MmOnUPHGEWCy0sdLGrGhqxFPEUVXTKV/IeKxy3uKslauseU/+wnBOX1nmOs1hJLCIJUgQoaCKEsqwEaNVJ8VCivbjHfxDrl8il0KuEhg5FlCBBtn1g//B726t/OSElxSOA10vjvMxAgR3gUbNcb6PHadxAvifgSu95a/UgZlP0mstLXoE9G8DF9ctTdkDLneAwSdDNmVX8tMU8nng/Yy+KQsM3AKhNa+35j5OH4A0dZW8AQ4OgdECZa93eHdPe2//nmn29wO1PnJbKP2bpQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+MGCQoLIHtBBXMAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACiUlEQVRYw+3WTUrsTBSH8SepwlSS6m5EUUQQdANOXIRLcNS4StchjhwpNNKKNoHEVOfrpOsOLgk6u7wZvp1RAvklVZU6J//g5ubGK6WI4xiAMAwREf712G63TPE6TVNub2+x1hKGIQBJkmCMoes66roGoKqqEQ3n7+/vPD4+TvLae0/f96zXa1arFUdHRwRBwMnJCSJCnud/R6r175FrjdaaqV53XUcYhnx8fGCtJYoivPd8fX0xm81I0xTnHCKC1hrnHEEQ4L1Ha81Ur8uy5PX1FaUUs9kMay0AIoIxBhEZl1FrjVKKNE3J85y6rpnqdd/3WGvZbDYURUFRFL+QtRbnHABpmmKMIcsylFJEUcRUr0WEzWZDVVW0bTt+q6ZpMMaMcJhBURQkSUKe5+MMp/hwuVyy2+2Yz+fMZjOiKKLrOj4/P6mqiqIo+P7+pixL+r4nSRKccxhjeHp6YqoPrq+v/Xa7ZbfbYYwhjmO6rhtrOggCyrLEOUfbtogISZIQhiFaa+bzOVO8vru7o+/7cZdut1uyLOPh4YH7+3sAFosFSikAiqJAa42IICLEcTzJ6+fn57FmRYSmafDec35+jjGG9Xo9PnzYXEOnExGcc5N8GEUR1lpEBGstp6enYx0fHByMN/+Ew+GcY6oPoyiirmuOj4/RWlOWJXEcc3Z2RpIkHB4e4r1HKYX3nrIsx+urqyumep3n+dguRYTFYkFRFLy9vZFlGS8vL2M5Dcv8s7EMTeW/ej3UaV3XdF2HiBBF0YiGl/x8gFJqbC5TfbBcLr1zjqZpcM5hraXvewBWqxWXl5e/fiQiQtu2NE0DwMXFBVN8sM8D+zywzwP7PLDPA/s8sM8D//s88Afq83AMNMuXcwAAAABJRU5ErkJggg==",n.onload=()=>{var i=e.createTexture();i.fromImage(n),r.setTexture(i),a.link(),a.bind(),a.setUniform1i("_sampler",0),t.BOX_SHAPE={},t.BOX_SHAPE.mesh=r,t.BOX_SHAPE.shaderProg=a}}}class v{static create(){let t=new Float32Array(2);return Float32Array!=Float32Array&&(t[0]=0,t[1]=0),t}static clone(t){let e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}static fromValues(t,e){let r=new Float32Array(2);return r[0]=t,r[1]=e,r}static copy(t,e){return t[0]=e[0],t[1]=e[1],t}static set(t,e,r){return t[0]=e,t[1]=r,t}static add(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}static subtract(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}static multiply(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}static divide(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}static ceil(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}static floor(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}static min(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}static max(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}static round(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}static scale(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}static scaleAndAdd(t,e,r,a){return t[0]=e[0]+r[0]*a,t[1]=e[1]+r[1]*a,t}static distance(t,e){var r=e[0]-t[0],a=e[1]-t[1];return Math.hypot(r,a)}static squaredDistance(t,e){var r=e[0]-t[0],a=e[1]-t[1];return r*r+a*a}static length(t){var e=t[0],r=t[1];return Math.hypot(e,r)}static squaredLength(t){var e=t[0],r=t[1];return e*e+r*r}static negate(t,e){return t[0]=-e[0],t[1]=-e[1],t}static inverse(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}static normalize(t,e){var r=e[0],a=e[1],i=r*r+a*a;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}static dot(t,e){return t[0]*e[0]+t[1]*e[1]}static cross(t,e,r){var a=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=a,t}static lerp(t,e,r,a){var i=e[0],s=e[1];return t[0]=i+a*(r[0]-i),t[1]=s+a*(r[1]-s),t}static random(t,e){e=e||1;var r=2*Math.random()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}static transformMat2(t,e,r){var a=e[0],i=e[1];return t[0]=r[0]*a+r[2]*i,t[1]=r[1]*a+r[3]*i,t}static transformMat2d(t,e,r){var a=e[0],i=e[1];return t[0]=r[0]*a+r[2]*i+r[4],t[1]=r[1]*a+r[3]*i+r[5],t}static transformMat3(t,e,r){var a=e[0],i=e[1];return t[0]=r[0]*a+r[3]*i+r[6],t[1]=r[1]*a+r[4]*i+r[7],t}static transformMat4(t,e,r){let a=e[0],i=e[1];return t[0]=r[0]*a+r[4]*i+r[12],t[1]=r[1]*a+r[5]*i+r[13],t}static rotate(t,e,r,a){let i=e[0]-r[0],s=e[1]-r[1],n=Math.sin(a),h=Math.cos(a);return t[0]=i*h-s*n+r[0],t[1]=i*n+s*h+r[1],t}static angle(t,e){let r=t[0],a=t[1],i=e[0],s=e[1],n=r*r+a*a;n>0&&(n=1/Math.sqrt(n));let h=i*i+s*s;h>0&&(h=1/Math.sqrt(h));let o=(r*i+a*s)*n*h;return o>1?0:o<-1?Math.PI:Math.acos(o)}static zero(t){return t[0]=0,t[1]=0,t}static str(t){return"vec2("+t[0]+", "+t[1]+")"}static exactEquals(t,e){return t[0]===e[0]&&t[1]===e[1]}}class p{constructor(){this.reset()}calculateMatrix(){var t=new Float32Array(16);return i.identity(t),i.translate(t,t,this.pivot),i.rotateX(t,t,this.rotation[0]),i.rotateY(t,t,this.rotation[1]),i.rotateZ(t,t,this.rotation[2]),i.translate(t,t,[-this.pivot[0],-this.pivot[1],-this.pivot[2]]),i.translate(t,t,this.position),t}mergeMatrix(t){var e=new Float32Array(16);return i.multiply(e,this.calculateMatrix(),t)}reset(){this.position=new Float32Array(3),this.rotation=new Float32Array(3),this.size=new Float32Array(3),this.pivot=new Float32Array(3)}rotate(t,e,r){this.rotation[0]+=t,this.rotation[1]+=e,this.rotation[2]+=r}scale(t,e,r){this.size[0]+=t,this.size[1]+=e,this.size[2]+=r}translate(t,e,r){this.position[0]+=t,this.position[1]+=e,this.position[2]+=r}}var A="##########   #   ## P     ##   #   ##   ## ###       ##       ##       ##########",E=document.getElementById("cv");E.width=window.innerWidth,E.height=window.innerHeight;var y=new class extends p{constructor(){super(),this.projection=new Float32Array(16),this.view=new Float32Array(16),this.setCameraPerspective(Math.PI/2,window.innerWidth/window.innerHeight,.1,100),this.setCameraView([0,0,-.01],[0,0,0],[0,1,0])}passUniforms(t,e,r="view",a="projection",i="world"){t.setUniformMatrix4f(r,this.view),t.setUniformMatrix4f(a,this.projection),t.setUniformMatrix4f(i,this.mergeMatrix(e))}chageFov(t){this.setCameraPerspective(t,this.aspect,this.near,this.far)}setCameraPerspective(t,e,r,a){this.fov=t,this.aspect=e,this.near=r,this.far=a,i.perspective(this.projection,t,e,r,a)}setCameraView(t,e,r){this.eye=t,this.center=e,this.up=r,i.lookAt(this.view,t,e,r)}};y.translate(0,0,1),y.rotate(0,1,0);var b={};onkeydown=onkeyup=function(t){b[t.key]="keydown"==t.type};var x=new class{constructor(t,e){this.gl=t,this.wiz=new d(t),this.canvas=e,this.display=this.wiz.createDisplay(),this.shapes={},c.register(this.shapes,this.wiz),M.register(this.shapes,this.wiz),this.display.enableCulling()}clearColor(t,e,r,a){this.display.clearColor(t,e,r,a)}clear(){this.display.clear()}draw(t){t.draw(this)}}(E.getContext("webgl"),E);x.camera=y,E.onclick=()=>{E.requestPointerLock()};var w=[0,0];onmousemove=t=>{w[0]=t.movementX,w[1]=t.movementY};var T=new Float32Array(16);i.identity(T);var S=i.create(),U=new class{constructor(){this.world=new Float32Array(16),i.identity(this.world)}applyMatrix(t){this.world=t}draw(t){var e=t.shapes.BOX_SHAPE;e.shaderProg.bind();var r=i.create();e.shaderProg.setUniformMatrix4f("normalMatrix",r),t.camera.passUniforms(e.shaderProg,this.world),t.display.draw(e.mesh,e.shaderProg)}};U.applyMatrix(S);var R=new class{constructor(t=0,e=0,r=0,a=0){this.x=t,this.y=e,this.width=r,this.height=a,this.rect=new s,this.map={},this.objs=[]}setObjects(t){this.objs=t}setMap(t,e,r){this.map.data=t,this.map.w=e,this.map.h=r}draw(t){var e=Math.floor(this.width/this.map.w),r=Math.floor(this.height/this.map.h);this.rect.setDimensions(0,0,this.width+e-3,this.height+r-3),this.rect.setColor(0,0,.5,1),t.draw(this.rect),this.rect.setColor(.7,.7,.7,1),this.map.data.split("").forEach((a,i)=>{if("#"===a){var s=i%this.map.w,n=Math.floor(i/this.map.h);this.rect.setDimensions(Math.floor(s*e+Math.floor(e/2)),n*r+Math.floor(r/2),e,r),t.draw(this.rect)}}),this.rect.setColor(.7,.7,0,1);var a=e/2,i=r/2;this.objs.forEach(s=>{var n=s.x*(e*this.map.w)+e/2,h=s.y*(r*this.map.h)+e/2;this.rect.setDimensions(n+a/2,h+i/2,a,i),t.draw(this.rect)})}}(0,0,128,128),P=new class{constructor(t,e){this.x=t,this.y=e,this.vy=0,this.vx=0}getMapCoords(t,e){return{x:-this.x/t,y:-this.y/e}}move(t,e){this.vx+=t,this.vy+=e}update(){this.x+=this.vx,this.y+=this.vy,this.vx=0,this.vy=0}}(.5,.5);R.setMap(A,9,9);var F=[{x:.5,y:.5}],C=0;A.split("").forEach((t,e)=>{var r=e%9,a=Math.floor(e/9);"P"==t&&(P.x=-r,P.y=-a)}),R.setObjects(F),x.clearColor(0,0,0,1),setInterval(()=>{if(x.clear(),b.w){var t=[0,0];v.rotate(t,[0,-.05],[0,0],C),P.move(t[0],t[1]),.1}if(b.s){t=[0,0];v.rotate(t,[0,-.05],[0,0],C+Math.PI),P.move(t[0],t[1]),.1}if(b.a){t=[0,0];v.rotate(t,[0,-.05],[0,0],C-Math.PI/2),P.move(t[0],t[1]),.1}if(b.d){t=[0,0];v.rotate(t,[0,-.05],[0,0],C+Math.PI/2),P.move(t[0],t[1]),.1}C+=w[0]/100,P.update(),y.reset(),y.translate(P.x,0,P.y),y.rotate(0,C,0),A.split("").forEach((t,e)=>{if("#"==A[e]){var r=e%9,a=Math.floor(e/9);i.identity(S),i.translate(S,S,[r,0,a]),x.draw(U)}}),w=[0,0],F[0]=P.getMapCoords(9,9),x.draw(R)},1e3/30)}]);